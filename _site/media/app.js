(function(){function a(t,d){d=d||localStorage.getItem("lang")||"en",(!window.translations||!window.translations[d])&&(d="en");const e=window.translations[d]||window.translations.en;if(e&&typeof e=="object"&&t in e)return typeof e[t]=="string"?e[t]:t;const c=t.split(".");let i=e;for(const f of c)if(i&&typeof i=="object"&&f in i)i=i[f];else return t;return typeof i=="string"?i:t}window.switchLanguage=function(t){localStorage.setItem("lang",t),document.documentElement.setAttribute("lang",t),t==="km"?(document.documentElement.classList.add("font-khmer"),document.body.classList.add("font-khmer")):(document.documentElement.classList.remove("font-khmer"),document.body.classList.remove("font-khmer")),document.querySelectorAll("[data-translate]").forEach(function(e){const c=e.getAttribute("data-translate");if(c==="hero.name")return;const i=a(c,t);e.textContent=i}),document.querySelectorAll("[data-translate-placeholder]").forEach(function(e){const c=e.getAttribute("data-translate-placeholder");e.placeholder=a(c,t)}),window.Alpine&&setTimeout(function(){document.querySelectorAll('[x-data*="lang"]').forEach(function(e){e.__x&&e.__x.$data&&"lang"in e.__x.$data&&(e.__x.$data.lang=t)})},0);const d=document.querySelector("[data-translate-title]");if(d){const e=d.getAttribute("data-translate-title");document.title=a(e,t)+" - Lisoing Sem"}};function s(){const t=localStorage.getItem("lang")||"en";document.documentElement.setAttribute("lang",t),window.switchLanguage(t)}function r(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s(),window.addEventListener("load",function(){const t=localStorage.getItem("lang")||"en";t!=="en"&&window.switchLanguage(t)})}r()})();(function(){const a=document.getElementById("main-content");let s=!1;const r=document.getElementById("progress-bar"),t=document.getElementById("progress-bar-fill");function d(){const o=window.location.pathname;return o==="/"||o==="/index.html"||o===""?"index":o.replace(/^\//,"").replace(/\.html$/,"")||"index"}function e(){const o=d();document.querySelectorAll(".nav-link").forEach(n=>{const l=n.getAttribute("data-page")||(n.getAttribute("href")==="/"?"index":n.getAttribute("href").replace(/^\//,"").replace(/\.html$/,"")),u=["bg-indigo-100","dark:bg-indigo-900/30","text-indigo-600","dark:text-indigo-400"],m=["text-gray-700","dark:text-gray-300"];l===o?(n.classList.add(...u),n.classList.remove(...m)):(n.classList.remove(...u),n.classList.add(...m))})}function c(){!r||!t||(r.style.display="block",t.style.width="30%",setTimeout(()=>{t.style.width="70%"},200))}function i(){!r||!t||(t.style.width="100%",setTimeout(()=>{r.style.display="none",t.style.width="0%"},300))}function f(){!r||!t||(r.style.display="none",t.style.width="0%")}async function g(o){if(!(s||!a)){s=!0;try{c();const n=await fetch(o);if(!n.ok)throw new Error("Failed to load page");t&&(t.style.width="90%");const l=await n.text(),m=new DOMParser().parseFromString(l,"text/html"),h=m.getElementById("main-content");if(!h)throw new Error("Content not found");a.style.opacity="0",a.style.transition="opacity 0.2s ease-in-out",setTimeout(()=>{a.innerHTML=h.innerHTML;const y=m.querySelector("title");if(y&&(document.title=y.textContent),window.history.pushState({},"",o),e(),window.switchLanguage){const p=localStorage.getItem("lang")||"en";p!=="en"&&window.switchLanguage(p)}window.Alpine&&window.Alpine.initTree(a),a.style.opacity="1",document.body.style.opacity="1",window.scrollTo({top:0,behavior:"smooth"}),i(),s=!1},150)}catch(n){console.error("Navigation error:",n),f(),window.location.href=o,s=!1}}}function L(o){const n=o.getAttribute("href");if(!n||o.hostname&&o.hostname!==window.location.hostname||n.startsWith("#")||n.startsWith("mailto:")||n.startsWith("tel:")||o.getAttribute("target")==="_blank")return!1;const l=window.location.pathname+window.location.search,u=new URL(n,window.location.origin).pathname;return!(u===l||u==="/"&&l==="/index.html")}function b(o){const n=o.target.closest("a");n&&L(n)&&(o.preventDefault(),g(n.getAttribute("href")))}function v(){g(window.location.pathname+window.location.search)}function w(){document.addEventListener("click",b,!0),window.addEventListener("popstate",v),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e(),window.addEventListener("load",function(){e(),document.body.classList.remove("page-loading"),document.body.classList.add("page-loaded")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",w):w()})();(function(){function a(){(localStorage.getItem("lang")||"en")==="km"?(document.documentElement.classList.add("font-khmer"),document.body.classList.add("font-khmer")):(document.documentElement.classList.remove("font-khmer"),document.body.classList.remove("font-khmer"))}function s(){document.body.style.opacity="0",requestAnimationFrame(function(){document.body.style.transition="opacity 0.3s ease-in-out",document.body.style.opacity="1"})}function r(){a(),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s()}r()})();
